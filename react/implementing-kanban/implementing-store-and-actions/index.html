<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta
      name='viewport'
      content='width=device-width, initial-scale=1, maximum-scale=1, minimal-ui' />
    <meta
      name='description'
      content=SurviveJS />
    <meta
      name='keywords'
      content= />
    <title>SurviveJS</title>
    
    <link rel='icon' type='image/png' href='/assets/favicon.png'></link>

    
      <link href="/site.17316cb466d661c9c3c0.css" rel="stylesheet">
    
  </head>
  <body>
    <div><div class="chapter__wrapper"><div class="header-image" style="background-image:url(/d25cd3712ccad030c912e13589e442a3.jpg);"></div><h1 class="post__heading">Implementando NoteStore y NoteActions</h1><div class="header-extra">Public Domain</div><div class="toc-nav__wrapper"><h4 class="search-nav--header">Search</h4><input id="search"/><h4 class="toc-nav--header">Índice</h4><ul class="toc-nav"><li class="toc-intro"><a class="toc-nav__link intro" href="/react/introduction/">Introducción</a></li><li class="toc-part"><a class="toc-nav__link part" href="/react/getting-started/">Comenzando</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/getting-started/introduction-to-react/">Introducción a React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/getting-started/setting-up-the-project/">Configurando el Proyecto</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/getting-started/implementing-notes/">Implementando una Aplicación de Notas</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/getting-started/deleting-notes/">Borrado de Notas</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/getting-started/understanding-react-components/">Comprendiendo los Componentes de React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/getting-started/editing-notes/">Edición de Notas</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/getting-started/styling-notes/">Dando Estilo a la Aplicación de Notas</a></li><li class="toc-part"><a class="toc-nav__link part" href="/react/implementing-kanban/">Implementando Kanban</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/implementing-kanban/react-and-flux/">React y Flux</a></li><li class="toc-chapter"><span class="toc-nav__link toc-nav__link--current chapter">Implementando NoteStore y NoteActions</span></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/implementing-kanban/implementing-persistency/">Implementando Persistencia en localStorage</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/implementing-kanban/handling-data-dependencies/">Gestionado Dependencias de Datos</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/implementing-kanban/editing-lanes/">Editando los Carriles</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/implementing-kanban/drag-and-drop/">Implementado Arrastrar y Soltar</a></li><li class="toc-part"><a class="toc-nav__link part" href="/react/advanced-techniques/">Técnicas Avanzadas</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/advanced-techniques/testing-react/">Probando React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/advanced-techniques/typing-with-react/">Tipado con React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/advanced-techniques/styling-react/">Aplicando Estilo a React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/advanced-techniques/structuring-react-projects/">Estructurando Proyectos con React</a></li><li class="toc-part"><a class="toc-nav__link part" href="/react/appendices/">Apéndices</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/appendices/language-features/">Características del Lenguaje</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/appendices/understanding-decorators/">Entendiendo los Decoradores</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/react/appendices/troubleshooting/">Resolución de Problemas</a></li></ul></div><div class="chapter"><div class="post__content"><div class="chapter-content"><p>Ahora que hemos movido todo lo relacionado con la gestión de los datos al lugar correcto podemos centrarnos en implementar las partes que faltan - <code>NoteStore</code> (Almacén de Notas) y <code>NoteActions</code> (Acciones sobre las Notas). Ambas encapsularán tanto los datos de la aplicación como la lógica.</p>
<p>No importa qué gestor de estados acabes usando, siempre encontrarás equivalencias en los demás. En Redux puedes usar acciones que provocarán un cambio de estado mediante un reductor. En MobX puedes modelar una acción en una clase ES6. La idea es que manipules los datos dentro de la clase y que ésto provoque que MobX refresque los componentes cuando sea necesario.</p>
<p>La idea aquí es similar: configuraremos acciones que acabarán invocando métodos en el estado que modificarán este estado. Cuando el estado cambia las vistas se actualizan. Para comenzar podemos implementar un <code>NoteStore</code> y definir la lógica para manipularlo. Una vez hayamos hecho eso, habremos migrado nuestra aplicación a la arquitectura Flux.</p>
<h2 class="header"><a class="header-anchor" href="#configurando-un-notestore" id="configurando-un-notestore"></a><span class="text">Configurando un <code>NoteStore</code></span><a class="header-anchor-select" href="#configurando-un-notestore">#</a></h2>
<p>De momento mantenemos el estado de la aplicación en <code>App</code>. El primer paso para llevarlo a Alt es definir un almacén y utilizar el estado desde allí. Esto romperá con la lógica de nuestra aplicación de forma temporal ya que necesitamos llevar el estado también a Alt. Sin embargo, crear este almacén inicial es un buen paso para cumplir con nuestro objetivo.</p>
<p>Para configurar un almacén necesitamos llevar a cabo tres pasos. Necesitaremos configurarlo, conectarlo con Alt en el <code>Proveedor</code> y, finalmente, conectarlo con <code>App</code>.</p>
<p>Los almacenes se modelan en Alt usando clases ES6. Aqui tienes una implementación mínima modelada con nuestro estado actual.</p>
<p><strong>app/stores/NoteStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> uuid <span class="token keyword" >from</span> <span class="token string" >'uuid'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >NoteStore</span> <span class="token punctuation" >{</span>
  <span class="token function" >constructor</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >this</span><span class="token punctuation" >.</span>notes <span class="token operator" >=</span> <span class="token punctuation" >[</span>
      <span class="token punctuation" >{</span>
        id<span class="token punctuation" >:</span> uuid<span class="token punctuation" >.</span><span class="token function" >v4</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
        task<span class="token punctuation" >:</span> <span class="token string" >'Apender React'</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >{</span>
        id<span class="token punctuation" >:</span> uuid<span class="token punctuation" >.</span><span class="token function" >v4</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
        task<span class="token punctuation" >:</span> <span class="token string" >'Hacer la Colada'</span>
      <span class="token punctuation" >}</span>
    <span class="token punctuation" >]</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>El siguiente paso es conectar el almacén con el <code>Proveedor</code>. Es aquí donde el módulo <code>setup</code> se vuelve útil:</p>
<p><strong>app/components/Provider/setup.js</strong></p>
<pre><code class="lang-javascript"><div class="leanpub-delete">
<span class="token keyword" >export</span> <span class="token keyword" >default</span> alt <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span><span class="token punctuation" >}</span>
</div>
<div class="leanpub-insert">
<span class="token keyword" >import</span> NoteStore <span class="token keyword" >from</span> <span class="token string" >'../../stores/NoteStore'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> alt <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
  alt<span class="token punctuation" >.</span><span class="token function" >addStore</span><span class="token punctuation" >(</span><span class="token string" >'NoteStore'</span><span class="token punctuation" >,</span> NoteStore<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>
</div>
</code></pre>
<p>Podemos ajustar <code>App</code> para consumir los datos desde el almacén y así comprobar que lo que hemos hecho funciona. Esto romperá la lógica que tenemos, pero lo arreglaremos en la próxima sección. Cambia <code>App</code> como sigue para hacer que <code>notas</code> esté disponible:</p>
<p><strong>app/components/App.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >class</span> <span class="token class-name" >App</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
  <span class="token function" >constructor</span><span class="token punctuation" >(</span>props<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >super</span><span class="token punctuation" >(</span>props<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    <span class="token keyword" >this</span><span class="token punctuation" >.</span>state <span class="token operator" >=</span> <span class="token punctuation" >{</span>
      notes<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
        <span class="token punctuation" >{</span>
          id<span class="token punctuation" >:</span> uuid<span class="token punctuation" >.</span><span class="token function" >v4</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
          task<span class="token punctuation" >:</span> <span class="token string" >'Aprender React'</span>
        <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
        <span class="token punctuation" >{</span>
          id<span class="token punctuation" >:</span> uuid<span class="token punctuation" >.</span><span class="token function" >v4</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
          task<span class="token punctuation" >:</span> <span class="token string" >'Hacer la Colada'</span>
        <span class="token punctuation" >}</span>
      <span class="token punctuation" >]</span>
    <span class="token punctuation" >}</span>
  <span class="token punctuation" >}</span>
</div>
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
    <span class="token keyword" >const</span> <span class="token punctuation" >{</span>notes<span class="token punctuation" >}</span> <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>state<span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >const</span> <span class="token punctuation" >{</span>notes<span class="token punctuation" >}</span> <span class="token operator" >=</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >;</span>
</div>

    <span class="token keyword" >return</span> <span class="token punctuation" >(</span>
      <span class="token operator" >&lt;</span>div<span class="token operator" >></span>
<div class="leanpub-delete">
        <span class="token punctuation" >{</span><span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >.</span>test<span class="token punctuation" >}</span>
</div>
        <span class="token operator" >&lt;</span>button className<span class="token operator" >=</span><span class="token string" >"add-note"</span> onClick<span class="token operator" >=</span><span class="token punctuation" >{</span><span class="token keyword" >this</span><span class="token punctuation" >.</span>addNote<span class="token punctuation" >}</span><span class="token operator" >></span><span class="token operator" >+</span><span class="token operator" >&lt;</span><span class="token operator" >/</span>button<span class="token operator" >></span>
        <span class="token operator" >&lt;</span>Notes
          notes<span class="token operator" >=</span><span class="token punctuation" >{</span>notes<span class="token punctuation" >}</span>
          onNoteClick<span class="token operator" >=</span><span class="token punctuation" >{</span><span class="token keyword" >this</span><span class="token punctuation" >.</span>activateNoteEdit<span class="token punctuation" >}</span>
          onEdit<span class="token operator" >=</span><span class="token punctuation" >{</span><span class="token keyword" >this</span><span class="token punctuation" >.</span>editNote<span class="token punctuation" >}</span>
          onDelete<span class="token operator" >=</span><span class="token punctuation" >{</span><span class="token keyword" >this</span><span class="token punctuation" >.</span>deleteNote<span class="token punctuation" >}</span>
          <span class="token operator" >/</span><span class="token operator" >></span>
      <span class="token operator" >&lt;</span><span class="token operator" >/</span>div<span class="token operator" >></span>
    <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>

<div class="leanpub-delete">
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token function" >connect</span><span class="token punctuation" >(</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  test<span class="token punctuation" >:</span> <span class="token string" >'test'</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >(</span>App<span class="token punctuation" >)</span>
</div>
<div class="leanpub-insert">
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token function" >connect</span><span class="token punctuation" >(</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>notes<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  notes
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >(</span>App<span class="token punctuation" >)</span>
</div>
</code></pre>
<p>Si refrescas la aplicación verás exactamente lo mismo que antes. Esta vez, sin embargo, estaremos consumiendo los datos desde nuestro almacén. Como resultado nuestra lógica está rota. Esto es algo que tendremos que arreglar más adelante mientras definimos <code>NoteActions</code> y llevamos la manipulación del estado a <code>NoteStore</code>.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>Dado que <code>App</code> no dependerá más del estado, es posible convertirlo a un componente basado en funciones. A menudo la mayoría de tus componentes estarán basados en funciones precisamente por esta razón. Si no estás utilizando estado o referencias es seguro convertirlos a funciones.</blockquote><h2 class="header"><a class="header-anchor" href="#entendiendo-las-acciones" id="entendiendo-las-acciones"></a><span class="text">Entendiendo las Acciones</span><a class="header-anchor-select" href="#entendiendo-las-acciones">#</a></h2>
<p>Las acciones son uno de los conceptos principales de la arquitectura Flux. Para ser exactos, es una buena idea separar <strong>acciones</strong> de <strong>creadores de acciones</strong>. A menudo estos términos son intercambiables, pero hay una diferencia considerable.</p>
<p>Los creadores de acciones son literalmente funciones que <em>lanzan</em> acciones. El contenido de la acción será repartido a los almacenes que estén interesados. Puede ser útil pensar en ellos como mensajes dentro de un envoltorio que son repartidos.</p>
<p>Esta división es útil si quieres hacer acciones asíncronas. Puedes, por ejemplo, querer recuperar los datos iniciales de tu tablero Kanban. La operación puede ir bien o ir mal, lo cual te dará tres acciones distintas que lanzar. Puedes lanzar acciones cuando comienzas la consulta y cuando recibes una respuesta.</p>
<p>Todos estos datos son valiosos si te permiten controlar la interfaz del usuario. Puedes mostrar una barra de progreso mientras la consulta se está realizando y actualizar el estado de la aplicación una vez llegan los datos del servidor. Si la consulta falla puedes hacer que el usuario lo sepa.</p>
<p>Este asunto es igual en otros gestores de estados. A menudo modelas una acción como una función que devuelve una función que lanza acciones individuales como puede ser el seguimiento del progreso de las consultas. En un ingenuamente síncrono caso es suficiente con devolver directamente el resultado de la acción.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>La documentación oficial de Alt cubre las <a href="http://alt.js.org/docs/createActions/">acciones asíncronas</a> con más detalle.</blockquote><h2 class="header"><a class="header-anchor" href="#configurando-noteactions" id="configurando-noteactions"></a><span class="text">Configurando <code>NoteActions</code></span><a class="header-anchor-select" href="#configurando-noteactions">#</a></h2>
<p>Alt tiene un pequeño método de utilidades conocido como <code>alt.generateActions</code> que puede generar creadores de acciones simples por nosotros. Estos generadores símplemente enviarán los datos que les pasemos, así que conectaremos estas acciones con los almacenes relevantes. En este caso, estamos hablando del <code>NoteStore</code> que definimos anteriormente.</p>
<p>Con respecto a la aplicación, es suficiente con que modelemos las operaciones CRUD básicas (Crear, Leer, Actualizar y Borrar). Podemos saltarnos la lectura ya que es implícita, pero es útil tener las demás disponibles como acciones. Configura <code>NoteActions</code> usando <code>alt.generateActions</code> como sigue:</p>
<p><strong>app/actions/NoteActions.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> alt <span class="token keyword" >from</span> <span class="token string" >'../libs/alt'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> alt<span class="token punctuation" >.</span><span class="token function" >generateActions</span><span class="token punctuation" >(</span><span class="token string" >'create'</span><span class="token punctuation" >,</span> <span class="token string" >'update'</span><span class="token punctuation" >,</span> <span class="token string" >'delete'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</code></pre>
<p>Esto no hace mucho por sí mismo, aunque es un buen sitio para conectar las acciones con <code>App</code> para poder lanzarlas. Nos empezaremos a preocupar sobre las acciones individuales una vez hagamos que nuestro almacén sea más grande. Modifica <code>App</code> del siguiente modo para conectar las acciones:</p>
<p><strong>app/components/App.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> React <span class="token keyword" >from</span> <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> uuid <span class="token keyword" >from</span> <span class="token string" >'uuid'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> Notes <span class="token keyword" >from</span> <span class="token string" >'./Notes'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> connect <span class="token keyword" >from</span> <span class="token string" >'../libs/connect'</span><span class="token punctuation" >;</span>
<div class="leanpub-insert">
<span class="token keyword" >import</span> NoteActions <span class="token keyword" >from</span> <span class="token string" >'../actions/NoteActions'</span><span class="token punctuation" >;</span>
</div>

<span class="token keyword" >class</span> <span class="token class-name" >App</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>

<div class="leanpub-delete">
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token function" >connect</span><span class="token punctuation" >(</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>notes<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  notes
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >(</span>App<span class="token punctuation" >)</span>
</div>
<div class="leanpub-insert">
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token function" >connect</span><span class="token punctuation" >(</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>notes<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  notes
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span> <span class="token punctuation" >{</span>
  NoteActions
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >(</span>App<span class="token punctuation" >)</span>
</div>
</code></pre>
<p>Esto nos permitirá ejecutar cosas como <code>this.props.NoteActions.create</code> para poder lanzar acciones.</p>
<h2 class="header"><a class="header-anchor" href="#conectando-noteactions-con-notestore" id="conectando-noteactions-con-notestore"></a><span class="text">Conectando <code>NoteActions</code> con <code>NoteStore</code></span><a class="header-anchor-select" href="#conectando-noteactions-con-notestore">#</a></h2>
<p>Alt facilita un par de formas útiles con las que conectar acciones con almacenes:</p>
<ul>
<li><code>this.bindAction(NoteActions.CREATE, this.create)</code> - Enlaza una acción específica con un método específico.</li>
<li><code>this.bindActions(NoteActions)</code>- Enlaza todas las acciones con métodos por convención. Es decir, la acción <code>create</code> se enlazará con un método llamado <code>create</code>.</li>
<li><code>reduce(state, { action, data })</code> - Es posible implementar un método conocido como <code>reductor</code>, el cual imita la forma de trabajar de los reductores de Redux. La idea es devolver un nuevo estado basado en el estado actual y unos datos.</li>
</ul>
<p>Utilizaremos <code>this.bindActions</code> en caso de que confiar en la convención sea suficiente. Modifica el almacén como sigue para conectar las acciones y añadir datos iniciales a la lógica:</p>
<p><strong>app/stores/NoteStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> uuid <span class="token keyword" >from</span> <span class="token string" >'uuid'</span><span class="token punctuation" >;</span>
<div class="leanpub-insert">
<span class="token keyword" >import</span> NoteActions <span class="token keyword" >from</span> <span class="token string" >'../actions/NoteActions'</span><span class="token punctuation" >;</span>
</div>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >NoteStore</span> <span class="token punctuation" >{</span>
  <span class="token function" >constructor</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
<div class="leanpub-insert">
    <span class="token keyword" >this</span><span class="token punctuation" >.</span><span class="token function" >bindActions</span><span class="token punctuation" >(</span>NoteActions<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>

    <span class="token keyword" >this</span><span class="token punctuation" >.</span>notes <span class="token operator" >=</span> <span class="token punctuation" >[</span>
      <span class="token punctuation" >{</span>
        id<span class="token punctuation" >:</span> uuid<span class="token punctuation" >.</span><span class="token function" >v4</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
        task<span class="token punctuation" >:</span> <span class="token string" >'Learn React'</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >{</span>
        id<span class="token punctuation" >:</span> uuid<span class="token punctuation" >.</span><span class="token function" >v4</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
        task<span class="token punctuation" >:</span> <span class="token string" >'Do laundry'</span>
      <span class="token punctuation" >}</span>
    <span class="token punctuation" >]</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<div class="leanpub-insert">
  <span class="token function" >create</span><span class="token punctuation" >(</span>note<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'create note'</span><span class="token punctuation" >,</span> note<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
  <span class="token function" >update</span><span class="token punctuation" >(</span>updatedNote<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'update note'</span><span class="token punctuation" >,</span> updatedNote<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
  <span class="token keyword" >delete</span><span class="token punctuation" >(</span>id<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'delete note'</span><span class="token punctuation" >,</span> id<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
</div>
<span class="token punctuation" >}</span>
</code></pre>
<p>Para poder verlo en funcionamiento necesitamos conectar nuestras acciones con <code>App</code> y adaptar la lógica.</p>
<h2 class="header"><a class="header-anchor" href="#migrando-app-addnote-a-flux" id="migrando-app-addnote-a-flux"></a><span class="text">Migrando <code>App.addNote</code> a Flux</span><a class="header-anchor-select" href="#migrando-app-addnote-a-flux">#</a></h2>
<p><code>App.addNote</code> es un buen punto en el que comenzar. El primer paso es lanzar la acción asociada (<code>NoteActions.create</code>) desde el método y comprobar si podemos ver algo en la consola del navegador. Si podemos, entonces podemos manipular el estado. Lanza una acción con la siguiente:</p>
<p><strong>app/components/App.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >class</span> <span class="token class-name" >App</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
  <span class="token punctuation" >}</span>
  addNote <span class="token operator" >=</span> <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
    <span class="token comment" spellcheck="true">// Es posible escribir esto de forma imperativa, es decir,</span>
    <span class="token comment" spellcheck="true">// a través de `this.state.notes.push` y, después,</span>
    <span class="token comment" spellcheck="true">// `this.setState({notes: this.state.notes})`.</span>
    <span class="token comment" spellcheck="true">//</span>
    <span class="token comment" spellcheck="true">// Suelo favorecer el estilo funcional cuando tiene sentido.</span>
    <span class="token comment" spellcheck="true">// Incluso cuando es necesario escribir más código, ya que</span>
    <span class="token comment" spellcheck="true">// prefiero los beneficios (facilidad para razonar, no</span>
    <span class="token comment" spellcheck="true">// efectos colaterales) que trae consigo.</span>
    <span class="token comment" spellcheck="true">//</span>
    <span class="token comment" spellcheck="true">// Algunas librerias, como Immutable.js, van un paso más allá.</span>
    <span class="token keyword" >this</span><span class="token punctuation" >.</span><span class="token function" >setState</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
      notes<span class="token punctuation" >:</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>state<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >concat</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span><span class="token punctuation" >{</span>
        id<span class="token punctuation" >:</span> uuid<span class="token punctuation" >.</span><span class="token function" >v4</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
        task<span class="token punctuation" >:</span> <span class="token string" >'New task'</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >]</span><span class="token punctuation" >)</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >.</span>NoteActions<span class="token punctuation" >.</span><span class="token function" >create</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
      id<span class="token punctuation" >:</span> uuid<span class="token punctuation" >.</span><span class="token function" >v4</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
      task<span class="token punctuation" >:</span> <span class="token string" >'New task'</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
  <span class="token punctuation" >}</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>Si refrescas el navegador y pulsas sobre el botón &quot;añadir nota&quot; deberías ver mensajes como el siguiente en la consola del navegador:</p>
<pre><code class="lang-bash">create note Object <span class="token punctuation" >{</span>id: <span class="token string" >"62098959-6289-4894-9bf1-82e983356375"</span>, task: <span class="token string" >"New task"</span><span class="token punctuation" >}</span>
</code></pre>
<p>Esto significa que tenemos los datos que necesitamos en el método <code>create</code> de <code>NoteStore</code>. Aún necesitamos manipular los datos, tras lo cual habremos cerrado el ciclo y deberíamos ver notas nuevas a través de la interfaz de usuario. Aquí Alt tiene un API similar al de React. Considera la siguiente implementación:</p>
<p><strong>app/stores/NoteStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> uuid <span class="token keyword" >from</span> <span class="token string" >'uuid'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> NoteActions <span class="token keyword" >from</span> <span class="token string" >'../actions/NoteActions'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >NoteStore</span> <span class="token punctuation" >{</span>
  <span class="token function" >constructor</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
  <span class="token punctuation" >}</span>
  <span class="token function" >create</span><span class="token punctuation" >(</span>note<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'create note'</span><span class="token punctuation" >,</span> note<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >this</span><span class="token punctuation" >.</span><span class="token function" >setState</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
      notes<span class="token punctuation" >:</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >concat</span><span class="token punctuation" >(</span>note<span class="token punctuation" >)</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
  <span class="token punctuation" >}</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>Si intentas añadir una nota, la actualización funcionará. Alt es quien mantiene el estado ahora y la edición se mantiene gracias a la arquitectura que hemos configurado. Todavía tenemos que repetir el proceso para el resto de métodos que faltan para poder completar el trabajo.</p>
<h2 class="header"><a class="header-anchor" href="#migrando-app-deletenote-a-flux" id="migrando-app-deletenote-a-flux"></a><span class="text">Migrando <code>App.deleteNote</code> a Flux</span><a class="header-anchor-select" href="#migrando-app-deletenote-a-flux">#</a></h2>
<p>El proceso es exáctamente el mismo para <code>App.deleteNote</code>. Necesitamos conectarlo con nuestra acción y adaptar el código. He aquí la parte de <code>App</code>:</p>
<p><strong>app/components/App.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >class</span> <span class="token class-name" >App</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
  deleteNote <span class="token operator" >=</span> <span class="token punctuation" >(</span>id<span class="token punctuation" >,</span> e<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
    <span class="token comment" spellcheck="true">// Avoid bubbling to edit</span>
    e<span class="token punctuation" >.</span><span class="token function" >stopPropagation</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

<div class="leanpub-delete">
    <span class="token keyword" >this</span><span class="token punctuation" >.</span><span class="token function" >setState</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
      notes<span class="token punctuation" >:</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>state<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >filter</span><span class="token punctuation" >(</span>note <span class="token operator" >=</span><span class="token operator" >></span> note<span class="token punctuation" >.</span>id <span class="token operator" >!==</span> id<span class="token punctuation" >)</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >.</span>NoteActions<span class="token punctuation" >.</span><span class="token keyword" >delete</span><span class="token punctuation" >(</span>id<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
  <span class="token punctuation" >}</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>Si refrescas y tratas de borrar una nota verás un mensaje como el siguiente en la consola del navegador:</p>
<pre><code class="lang-bash">delete note 501c13e0-40cb-47a3-b69a-b1f2f69c4c55
</code></pre>
<p>Para finalizar la migración necesitamos mostrar la lógica de <code>setState</code> al método <code>delete</code>. Recuerda borrar <code>this.state.notes</code> y reemplazarlo simplemente por <code>this.notes</code>:</p>
<p><strong>app/stores/NoteStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> uuid <span class="token keyword" >from</span> <span class="token string" >'uuid'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> NoteActions <span class="token keyword" >from</span> <span class="token string" >'../actions/NoteActions'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >NoteStore</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
  <span class="token keyword" >delete</span><span class="token punctuation" >(</span>id<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'delete note'</span><span class="token punctuation" >,</span> id<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >this</span><span class="token punctuation" >.</span><span class="token function" >setState</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
      notes<span class="token punctuation" >:</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >filter</span><span class="token punctuation" >(</span>note <span class="token operator" >=</span><span class="token operator" >></span> note<span class="token punctuation" >.</span>id <span class="token operator" >!==</span> id<span class="token punctuation" >)</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>Tras este cambio deberías poder borrar notas como antes. Todavía hay un par de métodos que migrar.</p>
<h2 class="header"><a class="header-anchor" href="#migrando-app-activatenoteedit-a-flux" id="migrando-app-activatenoteedit-a-flux"></a><span class="text">Migrando <code>App.activateNoteEdit</code> a Flux</span><a class="header-anchor-select" href="#migrando-app-activatenoteedit-a-flux">#</a></h2>
<p><code>App.activateNoteEdit</code> es básicamente una operación de actualización. Necesitamos cambiar el flag <code>editing</code> de la nota a <code>true</code>, lo cual iniciará el proceso de edición. Como siempre, deberemos migrar <code>App</code> primero:</p>
<p><strong>app/components/App.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >class</span> <span class="token class-name" >App</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
  activateNoteEdit <span class="token operator" >=</span> <span class="token punctuation" >(</span>id<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
    <span class="token keyword" >this</span><span class="token punctuation" >.</span><span class="token function" >setState</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
      notes<span class="token punctuation" >:</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>state<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span>note <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
        <span class="token keyword" >if</span><span class="token punctuation" >(</span>note<span class="token punctuation" >.</span>id <span class="token operator" >===</span> id<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
          note<span class="token punctuation" >.</span>editing <span class="token operator" >=</span> <span class="token boolean" >true</span><span class="token punctuation" >;</span>
        <span class="token punctuation" >}</span>

        <span class="token keyword" >return</span> note<span class="token punctuation" >;</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >)</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >.</span>NoteActions<span class="token punctuation" >.</span><span class="token function" >update</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>id<span class="token punctuation" >,</span> editing<span class="token punctuation" >:</span> <span class="token boolean" >true</span><span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
  <span class="token punctuation" >}</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>Si refrescas y tratas de editar una nota verás un mensaje como el siguiente en la consola del navegador:</p>
<pre><code class="lang-bash">update note Object <span class="token punctuation" >{</span>id: <span class="token string" >"2c91ba0f-12f5-4203-8d60-ea673ee00e03"</span>, editing: true<span class="token punctuation" >}</span>
</code></pre>
<p>Todavía necesitamos aplicar el cambio para hacer que esto funcione. La lógica es la misma que la que teniamos anteriormente en <code>App</code> con la excepción de que lo hemos generalizado usando <code>Object.assign</code>:</p>
<p><strong>app/stores/NoteStore.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> uuid <span class="token keyword" >from</span> <span class="token string" >'uuid'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> NoteActions <span class="token keyword" >from</span> <span class="token string" >'../actions/NoteActions'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >class</span> <span class="token class-name" >NoteStore</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
  <span class="token function" >update</span><span class="token punctuation" >(</span>updatedNote<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
    console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'update note'</span><span class="token punctuation" >,</span> updatedNote<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >this</span><span class="token punctuation" >.</span><span class="token function" >setState</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
      notes<span class="token punctuation" >:</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span>note <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
        <span class="token keyword" >if</span><span class="token punctuation" >(</span>note<span class="token punctuation" >.</span>id <span class="token operator" >===</span> updatedNote<span class="token punctuation" >.</span>id<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
          <span class="token keyword" >return</span> Object<span class="token punctuation" >.</span><span class="token function" >assign</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span><span class="token punctuation" >}</span><span class="token punctuation" >,</span> note<span class="token punctuation" >,</span> updatedNote<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
        <span class="token punctuation" >}</span>

        <span class="token keyword" >return</span> note<span class="token punctuation" >;</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >)</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
  <span class="token punctuation" >}</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>Ahora debería ser posible comenzar a editar notas, aunque si terminas de editarlas verás un error como <code>Uncaught TypeError: Cannot read property &#39;notes&#39; of null</code>. Esto se debe a que nos falta la parte final de la migración: cambiar <code>App.editNote</code>.</p>
<h2 class="header"><a class="header-anchor" href="#migrando-app-editnote-a-flux" id="migrando-app-editnote-a-flux"></a><span class="text">Migrando <code>App.editNote</code> a Flux</span><a class="header-anchor-select" href="#migrando-app-editnote-a-flux">#</a></h2>
<p>Esta parte final es sencilla. Ya tenemos la lógica que necesitamos, es sólo cuestión de conectar <code>App.editNote</code> correctamente con ella. Necesitaremos invocar a nuestro método <code>update</code> de una forma adecuada:</p>
<p><strong>app/components/App.jsx</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >class</span> <span class="token class-name" >App</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
  editNote <span class="token operator" >=</span> <span class="token punctuation" >(</span>id<span class="token punctuation" >,</span> task<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
    <span class="token keyword" >this</span><span class="token punctuation" >.</span><span class="token function" >setState</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
      notes<span class="token punctuation" >:</span> <span class="token keyword" >this</span><span class="token punctuation" >.</span>state<span class="token punctuation" >.</span>notes<span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span>note <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
        <span class="token keyword" >if</span><span class="token punctuation" >(</span>note<span class="token punctuation" >.</span>id <span class="token operator" >===</span> id<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
          note<span class="token punctuation" >.</span>editing <span class="token operator" >=</span> <span class="token boolean" >false</span><span class="token punctuation" >;</span>
          note<span class="token punctuation" >.</span>task <span class="token operator" >=</span> task<span class="token punctuation" >;</span>
        <span class="token punctuation" >}</span>

        <span class="token keyword" >return</span> note<span class="token punctuation" >;</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >)</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
    <span class="token keyword" >this</span><span class="token punctuation" >.</span>props<span class="token punctuation" >.</span>NoteActions<span class="token punctuation" >.</span><span class="token function" >update</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>id<span class="token punctuation" >,</span> task<span class="token punctuation" >,</span> editing<span class="token punctuation" >:</span> <span class="token boolean" >false</span><span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>Tras refrescar el navegador deberías ser capaz de modificar tareas de nuevo y la aplicación debería funcionar exactamente igual que antes. Modificar <code>NoteStore</code> incluyendo acciones ha provocado una cascada de actualizaciones sobre <code>App</code> que han hecho que todo se actualice mediante <code>setState</code>, lo que hará que el componente invoque a <code>render</code>. Este es el flujo unidireccional de Flux en acción.</p>
<p>Realmente ahora tenemos más código que antes, pero eso no importa. <code>App</code> está un poco más limpio y su desarollo es más fácil de continuar como veremos pronto. Lo más importante es que nos hemos apañado para implementar la arquitectura Flux en nuestra aplicación.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>Nuestra implementación actual es ingenua en el sentido de que no valida parámetros de ninguna forma. Puede ser una buena idea validar la forma de los objetos para evitar problemas durante el desarrollo. <a href="http://flowtype.org/">Flow</a> facilita una forma gradual de hacerlo. Aparte, puedes hacer tests que prueben el sistema.</blockquote><h3 class="header"><a class="header-anchor" href="#-para-qu-sirve-" id="-para-qu-sirve-"></a><span class="text">¿Para qué sirve?</span><a class="header-anchor-select" href="#-para-qu-sirve-">#</a></h3>
<p>Integrar un gestor de estados supone mucho esfuerzo, pero no es en vano. Ten en cuenta las siguiente preguntas:</p>
<ol>
<li>Supón que quieres almacenar las notas en el <code>localStorage</code>. ¿Dónde implementarías esta funcionalidad?. Una aproximación puede ser el módulo <code>setup</code> del <code>Proveedor</code>.</li>
<li>¿Qué ocurre si tenemos varios componentes que quieran utilizar los datos? Podemos consumirlos usando <code>connect</code> y mostrarlos.</li>
<li>¿Qué ocurre si tenemos muchas listas de notas separadas para distintos tipos de tareas?. Podemos crear otro almacén para hacer un seguimiento de esas listas. Ese almacén podrá referenciar las notas por id. Haremos algo parecido en el próximo capítulo.</li>
</ol>
<p>Adoptar un gestor de estados puede ser útil en el momento en el que tu aplicación React crezca. Esta abstracción tiene el coste de que tienes que escribir más código pero, por otro lado, si lo haces bien, acabarás con algo que será más fácil de razonar y de desarrollar más adelante. Cabe destacar que el flujo unidireccional utilizado por estos sistemas ayudan mucho tanto a la depuración como al testing.</p>
<h2 class="header"><a class="header-anchor" href="#conclusi-n" id="conclusi-n"></a><span class="text">Conclusión</span><a class="header-anchor-select" href="#conclusi-n">#</a></h2>
<p>Hemos visto en este capítulo cómo migrar una aplicación sencilla a una arquitectura Flux. Durante el proceso hemos aprendido más acerca de las <strong>acciones</strong> y los <strong>almacenes</strong> de Flux. Llegados a este punto estamos listos para añadir más funcionalidad a nuestra aplicación. Añadiremos persistencia basada en el <code>localStorage</code> a nuestra aplicación y realizaremos una pequeña limpieza por el camino.</p>
</div><div class="social-links"><blockquote class="tip">If you enjoyed this page, consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><h2 class="subscribe-header">Subscribe to the mailing list</h2><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;amp;id=b853b8e786" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate social-form" target="_blank" novalidate=""><div id="mc_embed_signup_scroll"><div class="mc-field-group social-input-container"><input type="email" placeholder="Email" value="" name="EMAIL" class="required email" id="mce-EMAIL"/></div><div style="display:none;position:absolute;left:-5000px;"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><div class="social-subscribe-container"><input type="submit" class="btn button social-subscribe" style="margin-top:1em;margin-bottom:1em;line-height:2em;" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"/></div></div></form></div><div class="new-prevnext"><div class="new-prevnext__prev"><div class="new-prevnext__bg" style="background-image:url(/c2c6fb3487ec955820af043223c44e59.jpg);"></div><span class="new-prevnext__info">Capítulo anterior</span><a class="new-prevnext__link" href="/react/implementing-kanban/react-and-flux/">React y Flux</a></div><div class="new-prevnext__next"><div class="new-prevnext__bg" style="background-image:url(/c20f3f8416e89f58debc98bb3099c9e6.jpg);"></div><span class="new-prevnext__info">Pŕoximo capítulo</span><a class="new-prevnext__link" href="/react/implementing-kanban/implementing-persistency/">Implementando Persistencia en localStorage</a></div></div><blockquote class="tip"><p>Puedes encontrar este libro en <a href="https://leanpub.com/survivejs-react">Leanpub</a>. Comprando este libro permitirás el desarrollo de más contenido.</p></blockquote><div id="disqus_thread"></div></div></div><div><a class="next-page" title="Implementando Persistencia en localStorage" href="/react/implementing-kanban/implementing-persistency/"><i class="icon-right-open"></i></a><a class="previous-page" title="React y Flux" href="/react/implementing-kanban/react-and-flux/"><i class="icon-left-open"></i></a></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div><div class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><nav class="nav"><div class="nav__link"><a href="/">Home</a></div><div class="nav__link"><a href="/blog/">Leer el blog</a></div><div class="nav__link"><a href="/training/">Formación</a></div><div class="nav__link"><a href="https://leanpub.com/survivejs-react">Compra el ebook</a></div><div class="nav__link"><a href="/"></a></div><div class="nav__link"><a href="https://twitter.com/survivejs">@survivejs</a></div></nav></div><a href="https://github.com/survivejs/site" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="position:absolute;top:0;fill:#000;right:0;"><path class="octo-banner" d="M0 0l115 115h15l12 27 108 108V0z" fill="#fff"></path><path class="octo-arm" d="M128 109c-15-9-9-19-9-19 3-7 2-11 2-11-1-7 3-2 3-2 4 5 2 11 2 11-3 10 5 15 9 16" style="-webkit-transform-origin:130px 106px;transform-origin:130px 106px;"></path><path class="octo-body" d="M115 115s4 2 5 0l14-14c3-2 6-3 8-3-8-11-15-24 2-41 5-5 10-7 16-7 1-2 3-7 12-11 0 0 5 3 7 16 4 2 8 5 12 9s7 8 9 12c14 3 17 7 17 7-4 8-9 11-11 11 0 6-2 11-7 16-16 16-30 10-41 2 0 3-1 7-5 11l-12 11c-1 1 1 5 1 5z"></path></svg></a><footer><div class="footer-wrapper"><div class="footer-content-wrapper"><div class="footer-social"><h3>Social</h3><ul><li><a href="https://twitter.com/survivejs" target="_blank" rel="noopener noreferrer">@survivejs</a></li><li><a href="http://eepurl.com/bth1v5" target="_blank" rel="noopener noreferrer">Mailing List</a></li><li><a href="https://gitter.im/survivejs" target="_blank" rel="noopener noreferrer">Gitter Chat</a></li><li><a href="https://github.com/survivejs" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="https://presentations.survivejs.com" target="_blank" rel="noopener noreferrer">Presentations</a></li><li><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank" rel="noopener noreferrer">Contact</a></li><li><a href="https://github.com/survivejs/ama/issues" target="_blank" rel="noopener noreferrer">Ask Me Anything</a></li></ul></div></div></div></footer><div><div class="gitter-open-chat-button">Need help?</div><script type="text/javascript">
          ((window.gitter = {}).chat = {}).options = {
            showChatByDefault: false,
            activationElement: '.gitter-open-chat-button',
            room: 'survivejs/react'
          };
        </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div></div>

    
  </body>
</html>
